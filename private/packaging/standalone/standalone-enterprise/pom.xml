<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <parent>
    <groupId>com.neo4j.assembly</groupId>
    <artifactId>neo4j-standalone-commercial</artifactId>
    <version>3.3.6-SNAPSHOT</version>
    <relativePath>..</relativePath>
  </parent>

  <groupId>com.neo4j.assembly</groupId>
  <artifactId>neo4j-enterprise-standalone</artifactId>
  <packaging>pom</packaging>

  <name>Neo4j Enterprise - Server Assembler</name>

  <version>3.3.6-SNAPSHOT</version>

  <description>
    This project assembles the Neo4j Enterprise stand-alone distribution,
    pulling together all the deliverable artifacts and packaging them
    into a downloadable installer.
  </description>
  <url>http://components.neo4j.org/${project.artifactId}/${project.version}</url>

  <scm>
    <connection>scm:git:git://github.com/neo4j/neo4j.git</connection>
    <developerConnection>scm:git:git@github.com:neo4j/neo4j.git</developerConnection>
    <url>https://github.com/neo4j/neo4j</url>
  </scm>

  <properties>
    <neo4j.mainClass>com.neo4j.server.enterprise.CommercialEntryPoint</neo4j.mainClass>
  </properties>

  <licenses>
    <license>
      <name>Neo4j Commercial license</name>
      <comments>
        Copyright (c) 2002-2018 "Neo Technology,"
        Network Engine for Objects in Lund AB [http://neotechnology.com]
        This file is a commercial add-on to Neo4j Enterprise Edition.
      </comments>
    </license>
  </licenses>

  <build>
    <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>properties-maven-plugin</artifactId>
        <executions>
          <execution>
            <phase>initialize</phase>
            <goals>
              <goal>read-project-properties</goal>
            </goals>
            <configuration>
              <files>
                <file>${project.parent.basedir}/document.properties</file>
                <file>${project.parent.basedir}/permalinks.properties</file>
              </files>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-assembly-plugin</artifactId>
        <configuration>
          <attach>false</attach>
          <finalName>${product.shortname}-enterprise-${project.version}</finalName>
          <appendAssemblyId>true</appendAssemblyId>
          <outputDirectory>${project.parent.build.directory}</outputDirectory>
          <delimiters>
            <!-- Because we are filtering shell scripts, which use '@' on windows and '${}' on *nix, change the
                 parameter substitution pattern to not clash with those. -->
            <delimiter>#{*}</delimiter>
          </delimiters>
        </configuration>
        <executions>
          <execution>
            <id>enterprise-unix-dist</id>
            <phase>package</phase>
            <goals>
              <goal>single</goal>
            </goals>
            <configuration>
              <descriptors>
                <descriptor>src/main/assemblies/enterprise-unix-dist.xml</descriptor>
              </descriptors>
              <filters>
                <filter>${project.parent.basedir}/tarball.properties</filter>
              </filters>
            </configuration>
          </execution>
          <execution>
            <id>enterprise-windows-dist</id>
            <phase>package</phase>
            <goals>
              <goal>single</goal>
            </goals>
            <configuration>
              <descriptors>
                <descriptor>src/main/assemblies/enterprise-windows-dist.xml</descriptor>
              </descriptors>
              <filters>
                <filter>${project.parent.basedir}/zip.properties</filter>
              </filters>
            </configuration>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <groupId>org.neo4j.build.plugins</groupId>
        <artifactId>licensing-maven-plugin</artifactId>
        <executions>
          <execution>
            <id>list-all-licenses</id>
            <configuration>
              <licensingRequirementFiles combine.children="append">
                <licensingRequirementFile>licensing-requirements-browser.xml</licensingRequirementFile>
              </licensingRequirementFiles>
              <excludedGroups>^((org.neo4j){1}|(org.neo4j.app){1}|(org.neo4j.server.plugin){1}|(org.neo4j.assembly){1}|(com.neo4j){1}|(com.neo4j.app){1}|(com.neo4j.server.plugin){1}|(com.neo4j.assembly){1})$</excludedGroups>

              <thirdPartyLicensingFilename>${project.artifactId}-${neo4j.version}-NOTICE.txt</thirdPartyLicensingFilename>
              <prependText>commercial-notice.txt</prependText>
              <checkExistingNoticeFile combine.self="override" />
              <listPrependText>list-prefix.txt</listPrependText>
              <listReport>${project.artifactId}-${neo4j.version}-LICENSES.txt</listReport>
              <checkExistingLicensesFile>${project.basedir}/src/main/distribution/text/enterprise/LICENSES.txt</checkExistingLicensesFile>
            </configuration>
          </execution>
        </executions>
      </plugin>

    </plugins>
  </build>

  <dependencies>
    <dependency>
      <groupId>org.neo4j</groupId>
      <artifactId>neo4j-enterprise</artifactId>
      <version>${project.version}</version>
    </dependency>
    <dependency>
      <groupId>org.neo4j.app</groupId>
      <artifactId>neo4j-server-enterprise</artifactId>
      <version>${project.version}</version>
    </dependency>
    <dependency>
      <groupId>com.neo4j.app</groupId>
      <artifactId>neo4j-server-commercial</artifactId>
      <version>${project.version}</version>
    </dependency>
  </dependencies>

</project>
